# Enforce [JIRA-ID] in the commit short summary
# And ensure that the JIRA-ID matches the id in the branch name

branch=$(git rev-parse --symbolic-full-name --abbrev-ref HEAD)
JIRA=$(echo $branch | cut -d / -f2 |cut -d - -f1-2)
 
KEY_FOUND=$(head -1 $1 | grep '\[[A-Z]\{1,\}-[0-9]\{1,\}\]' | cut -d ' ' -f1)
 
if [ "[$JIRA]" != "$KEY_FOUND" ]; then
    echo >&2 "[JIRA-ID] in commit message does not match the JIRA in branch name. $KEY_FOUND should be [$JIRA]."
    exit 1
fi
